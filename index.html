<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Feria Virtual de Emprendedores</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f3efdc;
      color: #24496e;
    }

    /* Pantalla de bienvenida */
    #welcome {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: linear-gradient(160deg, #da6863, #4d3069, #24496e);
      color: #f3efdc;
      text-align: center;
      padding: 2rem;
    }

    #welcome img {
      max-width: 150px;
      margin-bottom: 1rem;
    }

    #welcome h1 {
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }

    #welcome button {
      background: #f3efdc;
      color: #24496e;
      padding: 0.8rem 2rem;
      font-size: 1.1rem;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 1rem;
      transition: 0.3s;
    }

    #welcome button:hover {
      background: #da6863;
      color: #fff;
    }

    /* App */
    #app {
      display: none;
    }

    header {
      background: #4d3069;
      color: white;
      text-align: center;
      padding: 1rem;
    }

    .filters {
      display: flex;
      justify-content: center;
      margin: 1rem;
    }

    .filters select {
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #24496e;
      font-size: 1rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      padding: 1rem;
    }

    .card {
      background: white;
      border-radius: 3%;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .card:hover {
      transform: scale(1.05);
    }

    .card-horizontal {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      margin: 0.5rem 1rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      cursor: pointer;
    }

    .icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #fff;
      padding: 1.5rem;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .modal-content h2 {
      margin-top: 0;
      color: #4d3069;
    }

    .modal-content a {
      display: block;
      margin: 0.5rem 0;
      color: #da6863;
      font-weight: bold;
      text-decoration: none;
    }

    .close {
      float: right;
      font-size: 1.5rem;
      cursor: pointer;
      color: #24496e;
    }
  </style>
</head>
<body>
  <!-- Pantalla inicial -->
  <div id="welcome">
    <!-- Cambiar src por tu logo -->
    <img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/No-image-available.png" alt="Logo Docentes Brown">
    <h1>Feria Virtual de Emprendedores</h1>
    <p>Creada por Docentes Brown</p>
    <button onclick="startApp()">Ingresar a la feria</button>
  </div>

  <!-- App -->
  <div id="app">
    <header>
      <h1>Feria Virtual de Emprendedores</h1>
    </header>

    <div class="filters">
      <select id="filterMode">
        <option value="rubros">Orden Alfab√©tico - Rubros</option>
        <option value="emprendedores">Orden Alfab√©tico - Emprendedores</option>
      </select>
    </div>

    <div id="content"></div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="modal-title"></h2>
      <a id="modal-instagram" target="_blank">Instagram</a>
      <a id="modal-whatsapp" target="_blank">WhatsApp</a>
      <p id="modal-descuento"></p>
      <p id="modal-docente"></p>
    </div>
  </div>

  <script>
    const sheetId = "1B9t5EufUO848bFwv7tLJMt6mnh3qyeHXrZf5PKfCXuQ";
    const sheetUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

    let data = [];

    // Diccionario de √≠conos seg√∫n rubro
    const icons = {
      "Pasteler√≠a": "üç∞",
      "Gastronom√≠a": "üçΩÔ∏è",
      "Indumentaria": "üëó",
      "Accesorios": "üíç",
      "Tecnolog√≠a": "üíª",
      "Deco": "ü™¥",
      "Librer√≠a": "üìö",
      "Salud y Bienestar": "üíÜ‚Äç‚ôÄÔ∏è",
      "Arte": "üé®",
      "Servicios": "‚öôÔ∏è",
      "Otro": "üì¶"
    };

    function startApp() {
      document.getElementById("welcome").style.display = "none";
      document.getElementById("app").style.display = "block";
      loadData();
    }

    async function loadData() {
      const res = await fetch(sheetUrl);
      const text = await res.text();
      const json = JSON.parse(text.substr(47).slice(0,-2));
      data = json.table.rows.map(r => ({
        emprendimiento: r.c[0]?.v || "",
        rubro: r.c[1]?.v || "Otro",
        instagram: r.c[2]?.v || "",
        whatsapp: r.c[3]?.v || "",
        descuento: r.c[4]?.v || "",
        docente: r.c[5]?.v || ""
      }));
      render();
    }

    function render() {
      const mode = document.getElementById("filterMode").value;
      const content = document.getElementById("content");
      content.innerHTML = "";

      if (mode === "rubros") {
        const rubros = [...new Set(data.map(d => d.rubro))].sort();
        const grid = document.createElement("div");
        grid.className = "grid";
        rubros.forEach(r => {
          const card = document.createElement("div");
          card.className = "card";
          const icon = icons[r] || icons["Otro"];
          card.innerHTML = `<div class="icon">${icon}</div><div>${r}</div>`;
          card.onclick = () => showEmprendedoresPorRubro(r);
          grid.appendChild(card);
        });
        content.appendChild(grid);
      } else {
        const emprendedores = [...data].sort((a,b)=>a.emprendimiento.localeCompare(b.emprendimiento));
        emprendedores.forEach(e => {
          const card = document.createElement("div");
          card.className = "card-horizontal";
          card.innerHTML = `<div>${e.emprendimiento}</div>`;
          card.onclick = () => showModal(e);
          content.appendChild(card);
        });
      }
    }

    function showEmprendedoresPorRubro(rubro) {
      const emprendedores = data.filter(d => d.rubro === rubro).sort((a,b)=>a.emprendimiento.localeCompare(b.emprendimiento));
      const content = document.getElementById("content");
      content.innerHTML = "";

      const grid = document.createElement("div");
      grid.className = "grid";
      emprendedores.forEach(e => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<div>${e.emprendimiento}</div>`;
        card.onclick = () => showModal(e);
        grid.appendChild(card);
      });

      content.appendChild(grid);
    }

    function showModal(emp) {
      document.getElementById("modal-title").innerText = emp.emprendimiento;
      document.getElementById("modal-instagram").href = emp.instagram;
      document.getElementById("modal-instagram").innerText = emp.instagram;
      document.getElementById("modal-whatsapp").href = emp.whatsapp;
      document.getElementById("modal-whatsapp").innerText = emp.whatsapp;
      document.getElementById("modal-descuento").innerText = "Descuento: " + emp.descuento;
      document.getElementById("modal-docente").innerText = "Docente/Auxiliar: " + emp.docente;

      document.getElementById("modal").style.display = "flex";
    }

    document.querySelector(".close").onclick = () => {
      document.getElementById("modal").style.display = "none";
    };

    window.onclick = e => {
      if (e.target == document.getElementById("modal")) {
        document.getElementById("modal").style.display = "none";
      }
    };

    document.getElementById("filterMode").addEventListener("change", render);
  </script>
</body>
</html>
